# Whatever 播放器
### 1.项目描述

本项目旨在使用Qt框架开发一个界面简洁、操作直观的本地音乐播放器应用程序。该应用专注于核心的本地音乐播放功能，允许用户管理播放列表、控制播放流程，并能显示歌曲的基本信息和专辑封面。项目将充分利用Qt强大的多媒体模块和模型/视图架构，旨在构建一个跨平台、稳定流畅的个人音乐欣赏工具。

### 2. 核心功能与技术实现

#### 2.1 主界面与播放列表管理

- 功能描述：
  1. 友好的UI布局： 主窗口包含播放控制区（播放/暂停、上一曲/下一曲、进度条、音量控制）、歌曲信息展示区和播放列表区。
  2. 播放列表视图：
     - 使用列表清晰地展示当前播放列表中的所有歌曲，至少应包含歌曲标题和艺术家信息。
     - 用户可以通过点击列表中的歌曲来立即播放它。
  3. 添加与移除歌曲：
     - 提供“添加文件”和“添加文件夹”的功能，允许用户将本地的音频文件（如MP3, WAV, FLAC）添加到播放列表中。
     - 允许用户从播放列表中移除一首或多首选中的歌曲。
  4. 播放列表持久化： 应用程序关闭时，能够自动保存当前的播放列表；下次启动时，自动加载上一次的列表，方便用户继续收听。
- (关联Qt技术：QMainWindow, QTableView/QListView, Model/View架构, QFileDialog, QSettings)

#### 2.2 音频播放与控制

- 功能描述：
  1. 核心播放控制：
     - 提供“播放”、“暂停”和“停止”功能。
     - 提供“上一曲”和“下一曲”的功能，用于在播放列表中切换歌曲。
  2. 播放进度条：
     - 实时显示当前播放歌曲的进度，并显示当前播放时间和歌曲总时长。
     - 用户可以通过拖动进度条的滑块来快进或快退到歌曲的任意位置。
  3. 音量控制： 提供一个滑块，允许用户调节播放音量，并能实现静音功能。
  4. 播放模式： 支持多种播放模式的切换，至少包括：
     - 列表循环
     - 单曲循环
     - 随机播放
- (关联Qt技术：Qt Multimedia模块 (QMediaPlayer, QMediaPlaylist), QSlider, QPushButton)

#### 2.3 歌曲信息与专辑封面展示

- 功能描述：
  1. 元数据提取： 程序能够自动读取音频文件中的元数据（ID3 Tag等），并获取歌曲的标题、艺术家、专辑名称等信息。
  2. 信息实时显示： 在主界面的指定区域，实时显示当前正在播放歌曲的详细信息。
  3. 专辑封面显示：
     - 能够从音频文件中提取内嵌的专辑封面图片。
     - 如果文件内没有封面，则尝试在歌曲文件所在的目录下查找常见的封面图片文件（如folder.jpg, cover.jpg）。
     - 将获取到的封面图片展示在UI上。
- (关联Qt技术：Qt Multimedia模块 (QMediaMetaData), QLabel, QPixmap)

#### 2.4 用户体验与交互

- 功能描述：
  1. 流畅的交互逻辑： 应用程序的各UI组件间通过信号与槽机制进行高效、解耦的通信。
  2. 桌面与系统集成（可选）：
     - 程序运行时，在系统托盘区显示一个图标，右键点击图标可以进行简单的播放控制。
     - 当切换歌曲时，能够发送桌面通知（Desktop Notification），显示正在播放的新歌曲信息。
  3. 应用主题与样式： 提供至少两种颜色主题（如明亮/暗黑），用户可以根据喜好进行切换。
- (关联Qt技术：信号与槽机制, QSystemTrayIcon, QDesktopServices, QSS (Qt Style Sheets))

### 3. 可选的算法与数据结构深度优化

- 播放列表与搜索优化：
  - 数据结构：
    - 播放列表本身可以使用双向链表来实现，这样在执行“上一曲”/“下一曲”操作时，时间复杂度为O(1)。
    - 为了实现快速的按歌名、艺术家搜索，可以为这些字段建立倒排索引或前缀树（Trie），将搜索效率从遍历列表的O(N)提升至近似O(k)（k为搜索词长度）。
- 随机播放模式优化：
  - 算法：
    - 实现一个“真随机”且不重复的播放模式，可以使用经典的Fisher-Yates Shuffle (洗牌)算法。在进入随机模式时，一次性生成一个被打乱顺序的播放索引序列，然后按此序列播放，直到所有歌曲都播放完毕再重新洗牌。这避免了简单随机数可能导致的歌曲近期重复问题。
- 智能推荐与播放队列（高级功能）：
  - 算法与数据结构：
    - LRU缓存算法： 记录用户的播放历史，并使用LRU（Least Recently Used）算法的数据结构（哈希表 + 双向链表）来实现一个“最近播放”列表。
    - 协同过滤思想： 如果未来扩展为音乐库而非简单播放列表，可以分析用户的听歌习惯（如听完A后常听B），通过简单的协同过滤算法，在当前歌曲即将结束时，智能推荐下一首可能喜欢的歌曲，并加入到“即将播放”队列中。
- 歌词同步显示（高级功能）：
  - 算法与数据结构：
    - 数据结构： 将LRC歌词文件解析成一个按时间戳排序的列表或映射（Map），键为时间戳，值为歌词文本。
    - 算法： 在歌曲播放时，通过QMediaPlayer的positionChanged信号获取当前播放位置，然后使用二分查找算法在该排序列表中快速定位到当前时间点对应的歌词行，并高亮显示。

### 4. 关键技术栈

- 开发框架： Qt
- 编程语言： C++
- 核心Qt模块：
  - QtMultimedia: 提供音频播放和元数据处理的核心功能。
  - QtWidgets: 提供所有UI组件。
  - QtGui: 提供QIcon, QPixmap等基础图形类。
  - QtCore: 提供核心功能，如信号与槽, QFile, QSettings等。
